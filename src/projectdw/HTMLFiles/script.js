let JSONData='{"elaborations":{"results":[{"c":2675.3,"h":2714.0,"l":2623.33,"o":2713.99,"t":1633320000000},{"c":2723.54,"h":2747.24,"l":2680.0,"o":2680.0,"t":1633406400000},{"c":2747.08,"h":2757.04,"l":2689.73,"o":2692.51,"t":1633492800000},{"c":2783.71,"h":2803.0891,"l":2771.26,"o":2777.26,"t":1633579200000},{"c":2801.12,"h":2806.34,"l":2788.5868,"o":2798.12,"t":1633665600000},{"c":2776.95,"h":2815.2725,"l":2776.13,"o":2796.0,"t":1633924800000},{"c":2734.26,"h":2793.9,"l":2725.0,"o":2792.75,"t":1634011200000},{"c":2758.0,"h":2771.0,"l":2739.53,"o":2755.0,"t":1634097600000},{"c":2828.24,"h":2833.03,"l":2786.78,"o":2799.04,"t":1634184000000},{"c":2833.5,"h":2844.0,"l":2821.29,"o":2844.0,"t":1634270400000},{"c":2859.21,"h":2859.975,"l":2824.27,"o":2824.27,"t":1634529600000},{"c":2876.44,"h":2882.14,"l":2861.92,"o":2865.83,"t":1634616000000},{"c":2848.3,"h":2884.955,"l":2838.24,"o":2884.45,"t":1634702400000},{"c":2855.61,"h":2856.99,"l":2832.74,"o":2843.84,"t":1634788800000},{"c":2772.5,"h":2831.17,"l":2743.41,"o":2807.02,"t":1634875200000},{"c":2775.46,"h":2784.116,"l":2734.97,"o":2776.21,"t":1635134400000},{"c":2793.44,"h":2816.79,"l":2780.11,"o":2812.12,"t":1635220800000},{"c":2928.55,"h":2982.36,"l":2798.05,"o":2798.05,"t":1635307200000},{"c":2922.58,"h":2948.49,"l":2895.27,"o":2945.98,"t":1635393600000},{"c":2965.41,"h":2972.26,"l":2903.33,"o":2910.4,"t":1635480000000},{"c":2875.48,"h":2967.99,"l":2871.59,"o":2963.3,"t":1635739200000},{"c":2917.26,"h":2938.41,"l":2892.82,"o":2896.1877,"t":1635825600000},{"c":2935.8,"h":2938.21,"l":2901.07,"o":2925.5,"t":1635912000000},{"c":2973.66,"h":2999.0,"l":2932.7,"o":2944.0,"t":1635998400000},{"c":2984.82,"h":3011.4145,"l":2973.04,"o":2987.07,"t":1636084800000},{"c":2987.03,"h":3020.6899,"l":2982.4,"o":3000.0,"t":1636347600000},{"c":2984.97,"h":3007.57,"l":2950.14,"o":2994.92,"t":1636434000000},{"c":2932.52,"h":2973.9999,"l":2906.5,"o":2960.195,"t":1636520400000},{"c":2934.96,"h":2970.045,"l":2933.89,"o":2942.14,"t":1636606800000},{"c":2992.91,"h":2997.19,"l":2929.08,"o":2956.63,"t":1636693200000},{"c":2987.76,"h":3009.54,"l":2973.05,"o":3000.0,"t":1636952400000},{"c":2981.52,"h":2996.65,"l":2967.0,"o":2983.41,"t":1637038800000},{"c":2981.24,"h":2992.52,"l":2971.26,"o":2984.58,"t":1637125200000},{"c":3014.18,"h":3032.2,"l":2979.97,"o":2982.92,"t":1637211600000},{"c":2999.05,"h":3037.0,"l":2997.75,"o":3020.0,"t":1637298000000},{"c":2941.57,"h":3014.89,"l":2940.11,"o":3002.8352,"t":1637557200000},{"c":2935.14,"h":2953.88,"l":2897.79,"o":2942.26,"t":1637643600000},{"c":2934.35,"h":2940.0,"l":2903.98,"o":2927.0,"t":1637730000000},{"c":2856.12,"h":2905.9404,"l":2849.71,"o":2900.31,"t":1637902800000},{"c":2922.28,"h":2937.24,"l":2885.97,"o":2885.97,"t":1638162000000},{"c":2849.04,"h":2932.57,"l":2841.32,"o":2909.005,"t":1638248400000},{"c":2832.36,"h":2929.9825,"l":2830.0,"o":2884.25,"t":1638334800000},{"c":2875.53,"h":2893.5,"l":2819.64,"o":2836.48,"t":1638421200000},{"c":2850.41,"h":2904.2599,"l":2823.0,"o":2889.91,"t":1638507600000},{"c":2875.93,"h":2887.03,"l":2812.94,"o":2871.48,"t":1638766800000},{"c":2960.73,"h":2966.0,"l":2914.05,"o":2919.0,"t":1638853200000},{"c":2974.41,"h":2983.13,"l":2944.0,"o":2966.63,"t":1638939600000},{"c":2962.12,"h":2992.1,"l":2950.58,"o":2963.52,"t":1639026000000},{"c":2973.5,"h":2988.0,"l":2947.15,"o":2982.0,"t":1639112400000},{"c":2934.09,"h":2971.25,"l":2927.2,"o":2968.88,"t":1639371600000},{"c":2899.41,"h":2908.84,"l":2844.85,"o":2895.4,"t":1639458000000},{"c":2947.37,"h":2950.345,"l":2854.11,"o":2887.32,"t":1639544400000},{"c":2896.77,"h":2971.03,"l":2881.85,"o":2961.54,"t":1639630800000},{"c":2856.06,"h":2889.2019,"l":2835.76,"o":2854.29,"t":1639717200000},{"c":2848.03,"h":2852.21,"l":2805.0,"o":2813.5919,"t":1639976400000},{"c":2884.41,"h":2893.8413,"l":2834.7,"o":2863.0,"t":1640062800000},{"c":2938.98,"h":2946.06,"l":2879.26,"o":2882.0,"t":1640149200000},{"c":2942.85,"h":2971.4519,"l":2939.0168,"o":2941.79,"t":1640235600000},{"c":2961.28,"h":2968.53,"l":2945.0,"o":2949.27,"t":1640581200000},{"c":2928.96,"h":2967.49,"l":2918.71,"o":2967.49,"t":1640667600000},{"c":2930.09,"h":2943.675,"l":2910.09,"o":2928.59,"t":1640754000000},{"c":2920.05,"h":2941.25,"l":2915.17,"o":2929.0,"t":1640840400000},{"c":2893.59,"h":2927.3,"l":2893.55,"o":2910.88,"t":1640926800000},{"c":2901.49,"h":2911.0,"l":2870.05,"o":2889.51,"t":1641186000000},{"c":2888.33,"h":2932.2,"l":2876.3225,"o":2911.01,"t":1641272400000},{"c":2753.07,"h":2885.96,"l":2750.47,"o":2883.62,"t":1641358800000},{"c":2751.02,"h":2793.72,"l":2735.27,"o":2749.95,"t":1641445200000},{"c":2740.09,"h":2765.0949,"l":2715.78,"o":2758.1,"t":1641531600000},{"c":2771.48,"h":2772.8,"l":2662.81,"o":2701.98,"t":1641790800000},{"c":2800.35,"h":2806.59,"l":2736.27,"o":2763.61,"t":1641877200000},{"c":2832.96,"h":2856.2849,"l":2822.24,"o":2831.09,"t":1641963600000},{"c":2782.62,"h":2863.71,"l":2778.28,"o":2836.81,"t":1642050000000},{"c":2795.73,"h":2824.01,"l":2750.0,"o":2750.0,"t":1642136400000},{"c":2725.81,"h":2747.8299,"l":2712.34,"o":2732.0,"t":1642482000000},{"c":2713.04,"h":2767.99,"l":2710.0,"o":2738.77,"t":1642568400000},{"c":2670.13,"h":2758.24,"l":2662.89,"o":2730.28,"t":1642654800000},{"c":2601.84,"h":2695.21,"l":2600.02,"o":2660.24,"t":1642741200000},{"c":2607.44,"h":2615.57,"l":2492.839,"o":2520.55,"t":1643000400000},{"c":2534.71,"h":2586.77,"l":2527.56,"o":2568.71,"t":1643086800000},{"c":2584.8,"h":2656.15,"l":2543.07,"o":2611.85,"t":1643173200000},{"c":2582.42,"h":2652.1988,"l":2578.9,"o":2627.22,"t":1643259600000},{"c":2665.79,"h":2667.41,"l":2573.89,"o":2600.0,"t":1643346000000},{"c":2713.97,"h":2716.87,"l":2645.48,"o":2683.96,"t":1643605200000},{"c":2757.57,"h":2764.0,"l":2691.3645,"o":2756.7,"t":1643691600000},{"c":2960.73,"h":3042.0,"l":2911.1501,"o":3037.27,"t":1643778000000},{"c":2853.01,"h":2982.3544,"l":2844.1,"o":2905.9,"t":1643864400000},{"c":2860.32,"h":2890.705,"l":2796.35,"o":2860.34,"t":1643950800000},{"c":2778.76,"h":2876.9299,"l":2773.98,"o":2874.18,"t":1644210000000},{"c":2784.26,"h":2796.7424,"l":2737.46,"o":2779.825,"t":1644296400000},{"c":2829.06,"h":2843.51,"l":2807.54,"o":2816.995,"t":1644382800000},{"c":2772.05,"h":2828.62,"l":2761.0,"o":2790.0,"t":1644469200000},{"c":2682.6,"h":2785.665,"l":2665.77,"o":2775.0,"t":1644555600000},{"c":2706.0,"h":2723.3299,"l":2666.04,"o":2667.31,"t":1644814800000},{"c":2728.51,"h":2758.0,"l":2710.7901,"o":2749.43,"t":1644901200000},{"c":2749.75,"h":2758.92,"l":2696.4728,"o":2728.61,"t":1644987600000},{"c":2646.17,"h":2736.79,"l":2644.04,"o":2723.0,"t":1645074000000},{"c":2609.35,"h":2676.48,"l":2606.1405,"o":2660.75,"t":1645160400000}],"theoricalMaximum":6045,"howMuch":-104,"percentage":46.391752577319586,"frequentValues":{"2944":1,"2816":1,"2945":1,"2692":1,"2949":1,"2824":1,"2568":1,"2956":1,"2701":1,"2831":1,"2960":1,"2961":1,"2963":2,"2836":2,"2966":1,"2967":1,"2968":1,"2713":1,"2843":1,"2844":1,"2723":1,"2982":2,"2854":1,"2983":1,"2984":1,"2600":1,"2728":1,"2730":1,"2987":1,"2732":1,"2860":1,"2863":1,"2865":1,"2994":1,"2738":1,"2611":1,"2871":1,"3000":2,"3002":1,"2874":1,"2749":2,"2750":1,"2882":1,"2755":1,"2883":1,"2627":1,"2884":2,"2756":1,"2885":1,"2758":1,"2887":1,"2889":2,"2763":1,"3020":1,"2895":1,"2896":1,"2900":1,"2775":1,"2776":1,"2520":1,"2777":1,"2905":1,"2779":1,"2909":1,"3037":1,"2910":2,"2911":1,"2660":2,"2790":1,"2919":1,"2792":1,"2667":1,"2796":1,"2925":1,"2798":2,"2799":1,"2927":1,"2928":1,"2929":1,"2807":1,"2680":1,"2683":1,"2812":1,"2813":1,"2941":1,"2942":2}},"infoStock":{"symbol":"GOOG","exchange":"Nasdaq Global Select","name":"Alphabet Inc.","hq_address":"1600 Amphitheatre Parkway Mountain View CA, 94043","description":"Alphabet Inc is a provider of internet content products and portals. Its suite of brands includes Search, Android, YouTube, Apps, Maps \u0026 Ads."}}'

/*First Graph: Stock Trend*/
const obj=JSON.parse(JSONData);
document.getElementById('howMuch').innerHTML=obj.elaborations.howMuch;
document.getElementById('percentage').innerHTML=parseInt( obj.elaborations.percentage);
document.getElementById('theoricalMaximum').innerHTML=obj.elaborations.theoricalMaximum;
document.getElementById('name').innerHTML=obj.infoStock.name;
document.getElementById('description').innerHTML=obj.infoStock.description;
document.getElementById('symbol').innerHTML=obj.infoStock.symbol;
document.getElementById('hq_address').innerHTML=obj.infoStock.hq_address;
document.getElementById('exchange').innerHTML=obj.infoStock.exchange;

let startDate=convertData(obj.elaborations.results[0].t);
let finalDate=convertData(obj.elaborations.results[obj.elaborations.results.length-1].t);
document.getElementById("dates").innerHTML=startDate+" - "+ finalDate;


/*Progress Bar*/
let progressBar = document.querySelector(".circular-progress");
let valueContainer = document.querySelector(".value-container");

let progressValue = 0;
let progressEndValue = 100;
let speed = 300;

let progress = setInterval(() => {
  progressValue++;
  valueContainer.textContent = `${progressValue}%`;
  progressBar.style.background = `conic-gradient(
      #8b020d ${progressValue * 3.6}deg,
      #ffcccc ${progressValue * 3.6}deg
  )`;
  if (progressValue == progressEndValue) {
    clearInterval(progress);
  }
}, speed);


let unorderedkey=(Object.keys(obj.elaborations.frequentValues)); 
let orderedKey=unorderedkey.sort(function(a, b){return a - b});
let AllOrderedKey=getAllOrderedKey()
let AllFrequencyValues=getAllFrequencyValues()
function getAllOrderedKey(){
    let allOrderedKey=[];
    let min=orderedKey[0];
    let max=orderedKey[orderedKey.length-1]
    let numberOfValues=max-min;
    for (let i=0;i<numberOfValues+1;i++){
        allOrderedKey[i]=(parseInt(min)+i);
    }
   
    return allOrderedKey
}
function  getAllFrequencyValues(){
    let allOrderedFrequency=[]
    let count;
    for (let i=0;i<AllOrderedKey.length;i++){
        count=0
        for (let j=0;j<orderedKey.length;j++){
            if (AllOrderedKey[i]==orderedKey[j]){
                count++

            }
        }
        allOrderedFrequency[i]=count;
    }
    return allOrderedFrequency
}
/*function getFrequencyvalues(){
    let frequency=[]
    for (let i=0;i<orderedKey.length;i++){
        frequency[i]=obj.elaborations.frequentValues[orderedKey[i]]
    }
    return frequency
}
let frequentValuesArray=getFrequencyvalues()
function allOrderedKey(){
    
}*/
function getArrayDate(){ 
    let dayDates=[]
    for (let i=0;i<obj.elaborations.results.length;i++){
        dayDates[i]=convertData(obj.elaborations.results[i].t);
    }
    return dayDates;
}

function convertData(timeUnix){
    let realdate = new Date(timeUnix);
    return realdate.getDate()+"/"+(realdate.getMonth()+1)+"/"+realdate.getFullYear();
}
function getOpenValue(){
    let openValues=[]
    for (let i=0;i<obj.elaborations.results.length;i++){
        openValues[i]=obj.elaborations.results[i].o;
    }
    return openValues
}

let openValues=getOpenValue();
const labels = getArrayDate()



const data = {
    labels: labels,
    datasets: [{
        label: 'Open values',
        backgroundColor: [
            'rgb(248,249,250)',
        ],                
        borderColor: 'rgb(164,22,34)',
        data: openValues,
    }]
};


const data2 = {
    labels: AllOrderedKey,
    datasets: [{
        label: 'Open Values Frequency',
        data: AllFrequencyValues,
        backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(255, 159, 64, 0.2)',
            'rgba(255, 205, 86, 0.2)',
            'rgba(75, 192, 192, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(153, 102, 255, 0.2)',
            'rgba(201, 203, 207, 0.2)'
        ],
        borderColor: [
            'rgb(255, 99, 132)',
            'rgb(255, 159, 64)',
            'rgb(255, 205, 86)',
            'rgb(75, 192, 192)',
            'rgb(54, 162, 235)',
            'rgb(153, 102, 255)',
            'rgb(201, 203, 207)'
        ],
        borderWidth: 1
    }]
};

const config = {
    type: 'line',
    data: data,
    options: {}
};

const config2 = {
    type: 'bar',
    data: data2,
    options: {}
};

const myChart = new Chart(
    document.getElementById('myChart'),
    config
);

const myChart2 = new Chart(
    document.getElementById('myChart2'),
    config2
);

